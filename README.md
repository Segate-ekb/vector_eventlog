# **Vector_Eventlog.** Парсинг журнала регистрации 1С

- [Назначение](#назначение)
  - [Возможности](#возможности)
- [Запуск](#запуск)
- [Лицензия](#лицензия)

## Назначение

Проект создан для удобного экспорта журнала регистрации из 1 или больше баз.

### Возможности

- Vector_Eventlog - это конфигурация Vector для разбора и трансформации файлов журнала регистрации
- Предоставляет возможности экспорта журнала регистрации в различные форматы
- Выгрузка результатов парсинга в различных форматах
  - В файлы в различных форматах
  - В в консоль
  - В **Clickhouse**
  - В **Loki** и другие аггрегаторы логов
- Возможность масштабирования решения в случае большего объема логов
- Возможность сбора Журнала регистрации с нескольких серверов приложений, а так же с нескольких баз одновременно

## Варианты использования:

1. Сбор логов с одной базы.

    - Подготовьте docker-compose.yml
        - Укажите значения переменных для подключения к инстансу clickhouse. (`CH_SERVER`, `CH_USER`, `CH_PASSWORD`)
        - Укажите параметры используемой базы и таблиц(`CH_BASE_NAME`, `LOG_TABLE`, `ERROR_TABLE`)
    - Подготовьте базу clickhouse создав в ней базу и таблицы(воспользуйтесь примером скрипта [init.sql](/init.sql))
    - docker-compose up -d
1. Сбор логов с нескольких баз
    Для автоматического сбора логов с нескольких баз - используется таблица соответствия UUID базы на сервере приложений, и имени базы в ClickHouse.

    - Перед началом работы необходимо заполнить файл [BaseList.csv](/config/BaseList.csv) указав в первойй колонке UUID-базы на сервере, а во второй - имя базы в CH
    - Подготовьте необходимые базы Clickhouse. (воспользуйтесь примером скрипта [init.sql](/init.sql))
    - Подготовьте docker-compose.yml
        - Укажите значения переменных для подключения к инстансу clickhouse. (`CH_SERVER`, `CH_USER`, `CH_PASSWORD`)
        - Укажите параметры используемой базы и таблиц(`LOG_TABLE`, `ERROR_TABLE`)
        - Если у вас несколько серверов - откорректируйте docker-compose.yml в соотвествии с вашими потребностями. По умолчанию будут обрабатываться все логи которые примонтированы в `/var/log/eventlog`
        - !ВАЖНО! При маппинге используется UUID базы, потому он должен присутствовать в пути к файлам лога.
    - docker-compose up -d
---

## Лицензия

Distributed under the [Apache License, Version 2.0](http://www.apache.org/licenses/LICENSE-2.0.html)
